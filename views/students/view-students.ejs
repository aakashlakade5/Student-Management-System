<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <link rel="stylesheet" href="/css/style.css">


  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

</head>

<body>
  <!-- views/students/list.ejs -->
  <%- include('../partials/navbar') %>
  
  <!-- <div class="container mb-5"> -->
    
    <section class="" style="background-color: #eee; padding-top: 80px; padding-bottom: 20px;">
      <div class="container mb-5">
        <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col-lg-12 col-xl-11">
          <div class="card text-black" style="border-radius: 25px;">
            <div class="card-body p-md-5">
              <h3 class="text-center fw-bold mb-3">ðŸ‘€ View Students</h3>
              
              
              
              <%- include('../partials/searchFilter') %>
              
              
              
              
              <table class="table table-bordered table-hover align-middle text-center">
                <thead class="table-primary">
                  <% if (students.length===0) { %>
                    <tr>
                      <td colspan="5" class="text-center text-muted py-5 h4">No students found</td>
                      </tr>
                      <% } else { %>
                        <tr>
                          <th style="width: 5%;">Sr. No</th>
                          <th style="width: 16%;">Student ID</th>
                          <th style="width: 22%;">Name</th>
                          <th style="width: 10%;">Percentage</th>
                          <th style="width: 10%;">Actions</th>
                        </tr>
                      </thead>
                  <tbody>
                    <% students.forEach((s, index)=> { %>
                      <tr>
                        <td>
                          <%= skip + index + 1 %>
                        </td>
                        <td>
                          <%= s.studentId %>
                        </td>
                        <td>
                          <%= s.name %>
                        </td>
                        
                        <td class="text-start">
                          
                          <% let totalMarks=0; let totalMax=0; s.subjects.forEach(sub=> {
                            totalMarks += sub.marks;
                            totalMax += sub.maxMarks;
                          });
                          let percentage = totalMax > 0 ? ((totalMarks / totalMax) * 100).toFixed(2) : 0;
                          %>

                            <span class="badge bg-success">
                              <%= percentage %>%
                            </span>

                        </td>
                        <td>
                          <a href="/view-students/view-1-student/<%= s._id %>" title="View" class="no-underline">
                            <i class="bi bi-eye-fill text-primary"></i>
                          </a>
                          <a href="/update-student/<%= s._id %>" title="Edit" class="ms-2 no-underline">
                            <i class="bi bi-pencil-square text-warning"></i>
                          </a>
                          <a href="/delete-student/<%= s._id %>" title="Delete" class="ms-2 no-underline">
                            <i class="bi bi-trash-fill text-danger"></i>
                          </a>
                        </td>


                        
                        

                      </tr>
                      <% }) %>
                        <% } %>
                  </tbody>
                </table>
                <div class="text-center mt-3">
                  <%- include('../partials/flash') %>
                  
                  <%- include('../partials/pegination') %>
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  <a href="/add-student" class="btn btn-primary me-3">Add New Student</a>
                  <a href="/dashboard" class="btn btn-outline-secondary">Back to Dashboard</a>
                </div>
                
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  <!-- </div> -->


    <%- include('../partials/footer') %>

</body>

</html>